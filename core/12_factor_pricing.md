# 第十二章：因子定价

> "什么是系统性收益来源？"

> **核心问题**：股票收益差异从何而来？什么风险值得补偿？因子是风险还是异象？
> **前置阅读**：[01. 有效市场假说](01_efficient_market_hypothesis.md)、[02. 行为金融](02_behavioral_finance.md)

---

## 核心概念定义

### 什么是因子？

**因子 (Factor)** 是指能够解释资产收益差异的共同特征或系统性来源。

**通俗解释**：

为什么有些股票涨得多，有些涨得少？因子试图回答这个问题。

```
传统观点：
    每只股票的收益都是独立的、随机的

因子观点：
    股票收益可以分解为：
    = 共同因子的影响 + 个股特有的部分

    例如：
    某股票收益 = 市场因子贡献 + 价值因子贡献 + 动量因子贡献 + 个股噪音
```

### 系统性风险 vs 特异性风险

| 类型 | 定义 | 能否分散 | 例子 |
|-----|------|---------|------|
| **系统性风险** | 影响所有/大部分资产的风险 | 不能 | 市场崩盘、经济衰退 |
| **特异性风险** | 只影响单个资产的风险 | 可以 | 公司丑闻、产品失败 |

**核心原理**：

> 只有系统性风险才值得获得风险溢价。
>
> 因为特异性风险可以通过分散化消除，承担它不应该获得补偿。

### 风险溢价

**风险溢价 (Risk Premium)** 是投资者承担风险所要求的额外回报。

**例子**：

```
无风险利率 = 3%
股票预期收益 = 10%

股票风险溢价 = 10% - 3% = 7%

这 7% 是投资者承担股票市场风险所要求的补偿
```

---

## 一、CAPM：单因子模型

### 理论起源

**资本资产定价模型 (Capital Asset Pricing Model, CAPM)** 是 Sharpe (1964)、Lintner (1965)、Mossin (1966) 独立提出的。Sharpe 因此获得 1990 年诺贝尔经济学奖。

CAPM 是第一个系统性回答"风险与收益关系"的模型。

### 核心公式

$$E(R_i) = R_f + \beta_i \times [E(R_m) - R_f]$$

其中：
- $E(R_i)$ = 资产 i 的预期收益
- $R_f$ = 无风险利率
- $\beta_i$ = 资产 i 对市场的敏感度
- $E(R_m)$ = 市场组合的预期收益
- $E(R_m) - R_f$ = 市场风险溢价

**通俗解释**：

> 一只股票的预期收益，完全由它对市场的敏感度（Beta）决定。
>
> Beta 越高，风险越大，预期收益越高。

### Beta 的含义

**Beta ($\beta$)** 衡量资产收益对市场收益的敏感度。

$$\beta_i = \frac{Cov(R_i, R_m)}{Var(R_m)}$$

| Beta 值 | 含义 | 例子 |
|--------|------|------|
| β = 1 | 与市场同步波动 | 大盘指数基金 |
| β > 1 | 比市场波动更大 | 科技股、小盘股 |
| β < 1 | 比市场波动更小 | 公用事业、消费必需品 |
| β < 0 | 与市场反向波动 | 黄金（某些时期） |

**例子**：

```
假设：
    无风险利率 = 3%
    市场预期收益 = 10%
    某股票 β = 1.5

根据 CAPM：
    该股票预期收益 = 3% + 1.5 × (10% - 3%) = 13.5%

解释：
    因为这只股票比市场波动更大（β = 1.5）
    投资者要求更高的收益作为补偿
```

### CAPM 的假设

CAPM 建立在一系列严格假设之上：

| 假设 | 内容 | 现实性 |
|-----|------|-------|
| 投资者理性 | 均值-方差优化 | 部分成立 |
| 同质预期 | 所有人对未来预期相同 | 不成立 |
| 无交易成本 | 无税收、无佣金 | 不成立 |
| 无限制卖空 | 可以自由做空 | 部分成立 |
| 单期投资 | 只考虑一个投资期 | 简化假设 |
| 市场组合可投资 | 包含所有资产 | 难以实现 |

### CAPM 的实证失败

**CAPM 的核心预测**：Beta 是唯一决定预期收益的因素。

**实证发现**：Beta 与收益的关系远没有预测的那么强。

**Fama & French (1992) 的关键发现**：

```
按 Beta 排序的股票组合：
    高 Beta 组合收益 ≈ 低 Beta 组合收益

这与 CAPM 预测（高 Beta = 高收益）不符！
```

**其他异象**：

| 异象 | 发现 | 与 CAPM 的矛盾 |
|-----|------|---------------|
| **规模效应** | 小盘股收益更高 | Beta 无法解释 |
| **价值效应** | 低 P/B 股票收益更高 | Beta 无法解释 |
| **动量效应** | 过去赢家继续赢 | Beta 无法解释 |
| **低波动异象** | 低 Beta 股票风险调整后收益更高 | 直接矛盾 |

---

## 二、APT：套利定价理论

### 理论框架

**套利定价理论 (Arbitrage Pricing Theory, APT)** 由 Ross (1976) 提出，是对 CAPM 的扩展。

**核心思想**：

资产收益由**多个**共同因子驱动，而不是仅由市场因子驱动。

$$R_i = \alpha_i + \beta_{i1}F_1 + \beta_{i2}F_2 + ... + \beta_{ik}F_k + \varepsilon_i$$

其中：
- $F_1, F_2, ..., F_k$ = k 个共同因子
- $\beta_{i1}, \beta_{i2}, ...$ = 资产 i 对各因子的敏感度
- $\varepsilon_i$ = 特异性风险（可分散）

### APT vs CAPM

| 维度 | CAPM | APT |
|-----|------|-----|
| 因子数量 | 单因子（市场） | 多因子 |
| 理论基础 | 均衡定价 | 无套利 |
| 因子来源 | 理论推导（市场组合） | 不指定，需实证确定 |
| 假设强度 | 假设较多 | 假设较少 |

### APT 的局限

**关键问题**：APT 没有指定因子是什么。

```
APT 告诉你：
    收益由多个因子决定

APT 没告诉你：
    这些因子具体是什么
    有多少个因子
    如何识别它们
```

这个问题推动了实证资产定价的发展——通过数据找出真正重要的因子。

---

## 三、多因子模型的演进

### Fama-French 三因子模型 (1993)

针对 CAPM 的失败，Fama & French 提出了三因子模型：

$$R_i - R_f = \alpha_i + \beta_i(R_m - R_f) + s_i \cdot SMB + h_i \cdot HML + \varepsilon_i$$

**三个因子**：

| 因子 | 全称 | 构建方法 | 风险溢价 |
|-----|------|---------|---------|
| **MKT** | Market | 市场收益 - 无风险利率 | ~6%/年 |
| **SMB** | Small Minus Big | 小盘股收益 - 大盘股收益 | ~2-3%/年 |
| **HML** | High Minus Low | 高 B/M 收益 - 低 B/M 收益 | ~3-5%/年 |

> **B/M (Book-to-Market)** = 每股净资产 / 股价，是 P/B 的倒数。高 B/M 即低 P/B，代表价值股。

**模型的成功**：

三因子模型能解释大部分 CAPM 无法解释的异象：

```
规模效应 → 被 SMB 因子捕捉
价值效应 → 被 HML 因子捕捉

原本的"异象"变成了"风险溢价"
```

### Carhart 四因子模型 (1997)

Carhart 在三因子基础上增加了动量因子：

$$R_i - R_f = \alpha + \beta \cdot MKT + s \cdot SMB + h \cdot HML + w \cdot WML + \varepsilon$$

| 因子 | 全称 | 构建方法 | 风险溢价 |
|-----|------|---------|---------|
| **WML** | Winners Minus Losers | 过去赢家 - 过去输家 | ~6-8%/年 |

**动量因子的特殊性**：

- 收益很高，但风险解释困难
- 更像是行为异象而非风险补偿
- 这引发了"因子是风险还是异象"的争论

### Fama-French 五因子模型 (2015)

Fama & French 更新模型，增加了盈利和投资因子：

| 因子 | 全称 | 构建方法 | 逻辑 |
|-----|------|---------|------|
| **RMW** | Robust Minus Weak | 高盈利 - 低盈利 | 盈利能力强的公司收益更高 |
| **CMA** | Conservative Minus Aggressive | 低投资 - 高投资 | 保守投资的公司收益更高 |

**五因子公式**：

$$R_i - R_f = \alpha + \beta \cdot MKT + s \cdot SMB + h \cdot HML + r \cdot RMW + c \cdot CMA + \varepsilon$$

**争议**：五因子模型中 HML 变得不显著，这引发了关于价值因子的讨论。

### 因子模型总结

| 模型 | 年份 | 因子数 | 因子列表 |
|-----|------|-------|---------|
| CAPM | 1964 | 1 | MKT |
| FF3 | 1993 | 3 | MKT, SMB, HML |
| Carhart | 1997 | 4 | MKT, SMB, HML, WML |
| FF5 | 2015 | 5 | MKT, SMB, HML, RMW, CMA |
| FF6 | 2018 | 6 | 上述 + WML |

---

## 四、因子的本质争议

### 风险补偿 vs 行为异象

**核心问题**：因子收益是风险补偿还是市场错误定价？

| 观点 | 支持者 | 核心论点 |
|-----|-------|---------|
| **风险补偿** | Fama, French | 高收益是承担系统性风险的补偿 |
| **行为异象** | Lakonishok, Shleifer | 高收益是市场错误定价的结果 |

**这个争论为什么重要？**

```
如果是风险补偿：
    → 因子收益会持续存在
    → 但需要承担相应风险
    → "天下没有免费的午餐"

如果是行为异象：
    → 因子收益可能是"免费的午餐"
    → 但可能随着市场学习而消失
    → 需要警惕套利拥挤
```

### 主要因子的风险解释

**价值因子 (HML)**：

| 风险解释 | 逻辑 |
|---------|------|
| **财务困境风险** | 低估值公司往往面临财务困难，破产风险更高 |
| **经济周期风险** | 价值股在经济衰退时表现更差 |
| **久期风险** | 价值股的现金流更依赖近期，对贴现率敏感 |

**规模因子 (SMB)**：

| 风险解释 | 逻辑 |
|---------|------|
| **流动性风险** | 小盘股流动性差，危机时难以卖出 |
| **信息风险** | 小公司信息不透明，不确定性更大 |
| **经营风险** | 小公司更脆弱，倒闭概率更高 |

**动量因子 (WML)**：

动量因子最难用风险解释：

| 尝试的解释 | 问题 |
|-----------|------|
| 流动性风险 | 无法完全解释 |
| 宏观风险 | 证据不足 |
| **行为解释更有说服力** | 反应不足、处置效应 |

### 风险解释的检验

**如果因子是风险补偿，应该满足**：

1. **坏时期表现差**：风险资产在经济不好时亏损更多
2. **收益与风险对应**：高 Beta 资产收益更高
3. **持续性**：风险溢价长期存在

**实证检验结果**：

| 因子 | 坏时期表现 | 结论 |
|-----|-----------|------|
| 市场 | 熊市大跌 | 符合风险解释 |
| 价值 | 衰退期表现差 | 部分符合 |
| 规模 | 危机时小盘股跌更多 | 部分符合 |
| 动量 | 市场反转时崩溃 | 风险特征独特 |

---

## 五、复制危机与因子动物园

### 因子动物园 (Factor Zoo)

学术界发现了数百个"显著"的因子：

| 统计 | 数据 |
|-----|------|
| Harvey et al. (2016) 统计 | 316 个因子被发表 |
| Hou et al. (2020) 复制 | 452 个异象 |
| 每年新增 | 约 40 个 |

**讽刺的称呼**："因子动物园"——因子多得像动物园里的动物。

### 复制危机

**问题**：许多发表的因子在样本外不work。

**Hou, Xue & Zhang (2020) 的复制研究**：

```
复制 452 个异象
结果：
    - 64% 的异象无法复制
    - 复制成功的因子，收益也大幅下降
```

**McLean & Pontiff (2016) 的发现**：

```
因子发表后：
    - 样本内收益：平均 7.1%/年
    - 发表后收益：下降 32%
    - 发表后 5 年：下降 58%
```

### 为什么会这样？

**1. 数据挖掘 (Data Mining)**

```
如果你测试 100 个策略：
    即使都是随机的
    也有 5 个会在 5% 水平"显著"

学术界测试了成千上万的策略
"显著"的可能只是偶然
```

**2. 发表偏差 (Publication Bias)**

```
研究者发现"显著"结果 → 发表
研究者发现"不显著"结果 → 不发表

结果：
    发表的都是"显著"的
    但其中很多是假阳性
```

**3. p-hacking**

研究者可能通过调整：
- 样本期间
- 变量定义
- 控制变量
- 子样本选择

来获得"显著"的结果。

### 如何应对复制危机？

**Harvey et al. (2016) 的建议**：

| 传统标准 | 建议新标准 |
|---------|-----------|
| t > 2.0 (p < 5%) | t > 3.0 (p < 0.3%) |

**实践中的检验**：

| 检验 | 目的 |
|-----|------|
| **样本外检验** | 在不同时期、不同市场测试 |
| **经济逻辑** | 因子是否有合理解释 |
| **稳健性检验** | 变换定义后是否仍然有效 |
| **交易成本** | 扣除成本后是否仍有收益 |

---

## 六、经典因子详解

### 1. 市场因子 (MKT)

**最基本、最稳健的因子**。

| 特征 | 数据 |
|-----|------|
| 历史风险溢价 | ~6%/年（美国，1926-2020） |
| 波动率 | ~15-20%/年 |
| 夏普比率 | ~0.3-0.4 |

**风险解释**：投资者承担经济系统性风险的补偿。

### 2. 价值因子 (HML)

**构建方法**：

```
每年 6 月排序：
    按 B/M（账面市值比）分组
    高 B/M（前 30%）= 价值股
    低 B/M（后 30%）= 成长股

HML = 价值股平均收益 - 成长股平均收益
```

| 特征 | 数据 |
|-----|------|
| 历史风险溢价 | ~3-5%/年 |
| 波动率 | ~10-12%/年 |
| 夏普比率 | ~0.3-0.4 |
| 近年表现 | 2010-2020 显著走弱 |

**价值因子的周期性**：

```
1963-2006：价值跑赢成长 ~5%/年
2007-2020：价值跑输成长 ~3%/年
2021-2022：价值大幅跑赢
```

### 3. 规模因子 (SMB)

**构建方法**：

```
每年 6 月排序：
    按市值分组
    小市值（后 50%）= 小盘股
    大市值（前 50%）= 大盘股

SMB = 小盘股平均收益 - 大盘股平均收益
```

| 特征 | 数据 |
|-----|------|
| 历史风险溢价 | ~2-3%/年 |
| 波动率 | ~10-12%/年 |
| 稳定性 | 较弱，近年不显著 |

**规模效应的衰减**：

```
1926-1980：小盘股显著跑赢
1981-2000：效应减弱
2000-至今：几乎消失（美国市场）
```

可能原因：
- 效应被"套利掉了"
- 机构资金涌入小盘股
- 指数基金的普及

### 4. 动量因子 (WML)

**构建方法**：

```
每月排序：
    按过去 12 个月收益（跳过最近 1 个月）
    赢家（前 30%）
    输家（后 30%）

WML = 赢家平均收益 - 输家平均收益
```

| 特征 | 数据 |
|-----|------|
| 历史风险溢价 | ~6-8%/年 |
| 波动率 | ~15-20%/年 |
| 夏普比率 | ~0.4-0.5 |
| 最大回撤 | 极端（2009 年 -73%） |

**动量的特殊风险**：动量崩溃（详见 02 篇）

### 5. 盈利因子 (RMW)

**构建方法**：按营业利润率排序

| 特征 | 数据 |
|-----|------|
| 历史风险溢价 | ~3-4%/年 |
| 波动率 | ~8-10%/年 |
| 与价值因子 | 负相关 |

**逻辑**：盈利能力强的公司，未来表现更好。

### 6. 投资因子 (CMA)

**构建方法**：按资产增长率排序

| 特征 | 数据 |
|-----|------|
| 历史风险溢价 | ~2-3%/年 |
| 波动率 | ~6-8%/年 |

**逻辑**：激进投资的公司往往高估未来增长，收益较差。

---

## 七、因子投资实践

### Alpha vs Beta

**区分 Alpha 和 Beta**：

```
总收益 = Alpha + Beta × 因子收益

Alpha = 无法被因子解释的超额收益（"真正的能力"）
Beta = 因子暴露带来的收益（"承担风险的补偿"）
```

**例子**：

```
某基金年化收益 15%
无风险利率 3%
超额收益 = 12%

因子分解：
    市场 Beta = 1.2，贡献 1.2 × 6% = 7.2%
    价值暴露，贡献 2%
    动量暴露，贡献 1.5%

因子总贡献 = 10.7%
Alpha = 12% - 10.7% = 1.3%

结论：
    大部分收益来自因子暴露（Beta）
    真正的 Alpha 只有 1.3%
```

### Smart Beta

**Smart Beta** 是介于被动指数和主动管理之间的策略。

| 传统指数 | Smart Beta |
|---------|-----------|
| 市值加权 | 因子加权 |
| 被动持有 | 系统性暴露于特定因子 |
| 费用极低 | 费用较低 |
| 收益 = 市场 | 收益 = 市场 + 因子溢价 |

**常见的 Smart Beta 策略**：

| 策略 | 因子暴露 |
|-----|---------|
| 价值策略 | HML |
| 低波动策略 | 低 Beta |
| 质量策略 | RMW |
| 动量策略 | WML |
| 等权重 | SMB（隐含） |

### 因子择时

**问题**：能否预测因子表现，择时配置？

**实证结论**：非常困难。

```
因子收益可预测性很弱：
    - 估值指标对价值因子有一定预测力
    - 但信号噪音大，难以实际操作
    - 择时错误的成本很高
```

**实践建议**：

| 方法 | 适用情况 |
|-----|---------|
| **战略配置** | 长期持有多因子组合 |
| **再平衡** | 定期恢复目标因子暴露 |
| **避免极端择时** | 不要因短期表现完全放弃某因子 |

### 因子拥挤

**因子拥挤 (Factor Crowding)** 是指太多资金追逐同一因子。

**后果**：

```
因子被发现
    ↓
资金涌入
    ↓
因子股票被买贵
    ↓
未来收益下降
    ↓
极端情况：反转（拥挤瓦解）
```

**如何监测因子拥挤**：

| 指标 | 说明 |
|-----|------|
| 因子估值 | 因子多空组合的估值差距 |
| 资金流入 | Smart Beta 基金的规模增长 |
| 相关性 | 因子内部股票相关性上升 |

---

## 八、对量化交易的启示

### 1. 理解你的收益来源

**关键问题**：你的收益是 Alpha 还是 Beta？

```
检查方法：
    对收益进行因子归因
    看看能被因子解释的比例

如果大部分是 Beta：
    → 你可能只是承担了因子风险
    → 这些收益可以用更低成本的 Smart Beta 获取

如果有显著 Alpha：
    → 这才是真正的投资能力
```

### 2. 因子选择

**选择因子的标准**：

| 标准 | 说明 |
|-----|------|
| **经济逻辑** | 有合理的风险或行为解释 |
| **样本外有效** | 在不同市场、不同时期都有效 |
| **扣费后有效** | 考虑交易成本后仍有正收益 |
| **不过度拥挤** | 资金规模尚未过大 |

### 3. 多因子组合

**为什么要多因子？**

```
单因子风险：
    价值因子可能连续多年跑输
    动量因子可能突然崩溃

多因子优势：
    因子之间相关性低
    分散单因子风险
    更平稳的收益曲线
```

**因子相关性矩阵**（示意）：

| | MKT | HML | SMB | WML |
|---|-----|-----|-----|-----|
| MKT | 1.0 | | | |
| HML | 0.2 | 1.0 | | |
| SMB | 0.3 | -0.1 | 1.0 | |
| WML | -0.1 | -0.4 | 0.0 | 1.0 |

价值和动量负相关 — 组合使用效果好。

### 4. 警惕数据挖掘

**实践建议**：

- 对"新发现"的因子保持怀疑
- 要求 t > 3 而非 t > 2
- 检查经济逻辑是否合理
- 进行严格的样本外检验
- 考虑交易成本的影响

---

## 小结

**因子定价的发展脉络**：

```
CAPM（单因子）
    ↓ 实证失败
APT（多因子框架）
    ↓ 需要具体因子
FF3（市场、规模、价值）
    ↓ 无法解释动量
Carhart 4（加入动量）
    ↓ 盈利、投资也重要
FF5/FF6
    ↓ 因子太多
复制危机 → 回归基本
```

**核心要点**：

1. **CAPM 失败**：Beta 不能解释收益差异
2. **多因子模型**：规模、价值、动量、盈利、投资
3. **因子本质争议**：风险补偿 vs 行为异象
4. **复制危机**：大量因子无法复制，警惕数据挖掘
5. **实践应用**：区分 Alpha 和 Beta，多因子分散

**对量化交易的意义**：

> 因子是系统性收益的来源，但不是免费午餐。
>
> 理解因子的风险特性，才能正确使用它们。

---

## 延伸阅读

### 后续篇章

- [06. 市场微观结构：价格是如何形成的？](06_market_microstructure.md) — 从宏观因子到微观价格形成

### 参考文献

**核心论文**：

1. Sharpe, W. F. (1964). "Capital Asset Prices: A Theory of Market Equilibrium under Conditions of Risk." *Journal of Finance*.
2. Fama, E. F., & French, K. R. (1993). "Common Risk Factors in the Returns on Stocks and Bonds." *Journal of Financial Economics*.
3. Carhart, M. M. (1997). "On Persistence in Mutual Fund Performance." *Journal of Finance*.
4. Fama, E. F., & French, K. R. (2015). "A Five-Factor Asset Pricing Model." *Journal of Financial Economics*.
5. Harvey, C. R., Liu, Y., & Zhu, H. (2016). "...and the Cross-Section of Expected Returns." *Review of Financial Studies*.
6. Hou, K., Xue, C., & Zhang, L. (2020). "Replicating Anomalies." *Review of Financial Studies*.

**推荐书籍**：

1. Cochrane, J. H. (2005). *Asset Pricing*. — 资产定价的研究生教材
2. Ang, A. (2014). *Asset Management: A Systematic Approach to Factor Investing*. — 因子投资的实践指南
3. Ilmanen, A. (2011). *Expected Returns*. — 各类资产预期收益的百科全书
